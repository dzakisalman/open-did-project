<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OPEN DID Project</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .result {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            word-break: break-all;
        }
        .label {
            font-weight: bold;
            color: #495057;
            margin-bottom: 5px;
        }
        .wallet-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .wallet-section {
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê Buat Identitas Digital (DID)</h1>
        
        <div style="text-align: center;">
            <button id="createDidBtn">Buat DID</button>
            <button id="createWalletBtn">Buat Wallet DID</button>
            <button id="clearBtn">Hapus Data</button>
        </div>

        <div id="didDisplay" class="result" style="display: none;">
            <div class="label">DID:</div>
            <div id="didValue"></div>
        </div>

        <div id="jwtDisplay" class="result" style="display: none;">
            <div class="label">JWT:</div>
            <div id="jwtValue"></div>
        </div>

        <div id="walletDisplay" class="result" style="display: none;">
            <div class="label">Wallet DID:</div>
            <div id="walletValue"></div>
        </div>

        <div id="walletInfo" class="wallet-info" style="display: none;">
            <div class="wallet-section">
                <div class="label">Private Key:</div>
                <div id="privateKey"></div>
            </div>
            <div class="wallet-section">
                <div class="label">Public Key:</div>
                <div id="publicKey"></div>
            </div>
        </div>
    </div>

    <script>
        async function createDid() {
            // DID sederhana
            const did = 'did:example:' + Math.random().toString(36).substring(2, 15);
            document.getElementById('didValue').innerText = did;
            document.getElementById('didDisplay').style.display = 'block';

            // Membuat JWT (di browser, pakai library lain atau simulasikan)
            const payload = { 
                data: 'Contoh data untuk DID', 
                did: did,
                timestamp: new Date().toISOString()
            };
            const jwt = btoa(JSON.stringify(payload)); // simulasi JWT sederhana
            document.getElementById('jwtValue').innerText = jwt;
            document.getElementById('jwtDisplay').style.display = 'block';

            // Simpan ke localStorage
            localStorage.setItem('userDID', did);
            localStorage.setItem('userJWT', jwt);
            
            console.log('DID dan JWT dibuat:', { did, jwt });
        }

        function createWallet() {
            const wallet = {
                did: 'did:example:' + Math.random().toString(36).substring(2, 15),
                privateKey: 'private_key_' + Math.random().toString(36).substring(2, 15),
                publicKey: 'public_key_' + Math.random().toString(36).substring(2, 15),
                createdAt: new Date().toISOString()
            };

            document.getElementById('walletValue').innerText = JSON.stringify(wallet, null, 2);
            document.getElementById('walletDisplay').style.display = 'block';
            
            document.getElementById('privateKey').innerText = wallet.privateKey;
            document.getElementById('publicKey').innerText = wallet.publicKey;
            document.getElementById('walletInfo').style.display = 'grid';

            // Simpan ke localStorage
            localStorage.setItem('userWallet', JSON.stringify(wallet));
            
            console.log('Wallet DID dibuat:', wallet);
        }

        function clearData() {
            // Hapus dari DOM
            document.getElementById('didDisplay').style.display = 'none';
            document.getElementById('jwtDisplay').style.display = 'none';
            document.getElementById('walletDisplay').style.display = 'none';
            document.getElementById('walletInfo').style.display = 'none';
            
            // Hapus dari localStorage
            localStorage.removeItem('userDID');
            localStorage.removeItem('userJWT');
            localStorage.removeItem('userWallet');
            
            console.log('Data dihapus');
        }

        function loadStoredData() {
            const storedDID = localStorage.getItem('userDID');
            const storedJWT = localStorage.getItem('userJWT');
            const storedWallet = localStorage.getItem('userWallet');

            if (storedDID) {
                document.getElementById('didValue').innerText = storedDID;
                document.getElementById('didDisplay').style.display = 'block';
            }

            if (storedJWT) {
                document.getElementById('jwtValue').innerText = storedJWT;
                document.getElementById('jwtDisplay').style.display = 'block';
            }

            if (storedWallet) {
                const wallet = JSON.parse(storedWallet);
                document.getElementById('walletValue').innerText = JSON.stringify(wallet, null, 2);
                document.getElementById('walletDisplay').style.display = 'block';
                document.getElementById('privateKey').innerText = wallet.privateKey;
                document.getElementById('publicKey').innerText = wallet.publicKey;
                document.getElementById('walletInfo').style.display = 'grid';
            }
        }

        // Event listeners
        document.getElementById('createDidBtn').addEventListener('click', createDid);
        document.getElementById('createWalletBtn').addEventListener('click', createWallet);
        document.getElementById('clearBtn').addEventListener('click', clearData);

        // Load stored data when page loads
        window.addEventListener('load', loadStoredData);
    </script>
</body>
</html>
